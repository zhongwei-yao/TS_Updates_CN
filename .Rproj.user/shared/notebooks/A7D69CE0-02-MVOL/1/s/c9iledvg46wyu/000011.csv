"0","market_svar_m_csmar <- data.table::fread(market_pfmc_d_path) %>% "
"0","  tibble() %>% "
"0","  setlowercolnames() %>% "
"0","  filter(markettype == 117) %>% "
"0","  select(tradingdate = trddt, cdretwdos) %>% "
"0","  mutate(tradingdate = ymd(tradingdate), svar = cdretwdos * cdretwdos) %>% "
"0","  na.omit() %>% "
"0","  arrange(tradingdate) %>% "
"0","  mutate(svar = rollsumr(svar, 252, fill = NA)) %>% "
"0","  group_by(year(tradingdate), month(tradingdate)) %>% "
"0","  summarise(tradingdate = last(tradingdate), svar = last(svar)) %>% "
"0","  ungroup() %>% "
"0","  na.omit() %>% "
"0","  mutate(tradingmonth = ceiling_date(tradingdate, ""m"") - days(1)) %>% "
"0","  select(tradingmonth, svar)"
"2","`summarise()` has grouped output by 'year(tradingdate)'. You can override using the `.groups` argument."
"0","#< Write to the local database"
"0","dbWriteTable(conn_macro,"
"0","    ""market_svar_m_csmar"","
"0","    value = market_svar_m_csmar,"
"0","    overwrite = TRUE"
"0","  )"
