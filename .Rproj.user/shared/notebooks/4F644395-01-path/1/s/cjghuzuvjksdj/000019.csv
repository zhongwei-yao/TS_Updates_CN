"0","market_ret_freq_fun <- function(freq = NULL, mtype = NULL){"
"0","  freq_shortcut <- str_extract(freq, ""^.{1}"")"
"0","  market_ret_freq_path <- get(paste0(""market_ret_"", freq, ""_path""))"
"0","  if (freq == ""day""){"
"0","    select_var <- c(paste0(""trd"", freq_shortcut, ""t""), paste0(""c"", freq_shortcut, ""ret"", ""wdos""))"
"0","  }else{"
"0","    select_var <- c(paste0(""trd"", freq_shortcut, ""nt""), paste0(""c"", freq_shortcut, ""ret"", ""wdos""))"
"0","  }"
"0","  fread(market_ret_freq_path) %>% "
"0","    setlowercolnames() %>% "
"0","    .[markettype == mtype, ..select_var] %>%"
"0","    na.omit()"
"0","}"
"0",""
"0","market_ret_daily <- market_ret_freq_fun(freq = ""day"", mtype = 53)"
"0","dbWriteTable(conn_stock,"
"0","    ""market_ret_daily"","
"0","    value = market_ret_daily,"
"0","    overwrite = TRUE"
"0","  )"
"0",""
"0","market_ret_weekly <- market_ret_freq_fun(freq = ""week"", mtype = 53)"
"0",""
"0","dbWriteTable(conn_stock,"
"0","    ""market_ret_weekly"","
"0","    value = market_ret_weekly,"
"0","    overwrite = TRUE"
"0","  )"
"0",""
"0","market_ret_monthly <- market_ret_freq_fun(freq = ""month"", mtype = 53) %>% "
"0","  .[, tradingmonth := ymd(paste0(trdmnt, ""-01""))] %>% "
"0","  .[, trdmnt := NULL]"
"0",""
"0","dbWriteTable(conn_stock,"
"0","    ""market_ret_monthly"","
"0","    value = market_ret_monthly,"
"0","    overwrite = TRUE"
"0","  )"
"0",""
"0",""
